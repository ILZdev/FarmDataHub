<!DOCTYPE html>
<html lang="id" class="h-full">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sistem Manajemen Pertanian</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="/_sdk/element_sdk.js"></script>
    <script src="/_sdk/data_sdk.js"></script>
    <style>
      body {
        box-sizing: border-box;
      }
      .fade-in {
        animation: fadeIn 0.3s ease-in;
      }
      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
      .notification {
        animation: slideIn 0.3s ease-out;
      }
      @keyframes slideIn {
        from {
          transform: translateX(100%);
        }
        to {
          transform: translateX(0);
        }
      }
    </style>
    <style>
      @view-transition {
        navigation: auto;
      }
    </style>
  </head>
  <body class="h-full bg-gray-50">
    <div class="min-h-full">
      <!-- Navigation -->
      <nav class="bg-green-600 shadow-lg">
        <div class="max-w-7xl mx-auto px-4">
          <div class="flex justify-between h-16">
            <div class="flex items-center">
              <h1 id="app-title" class="text-xl font-bold text-white">
                Sistem Manajemen Pertanian
              </h1>
              <span id="farm-name" class="ml-4 text-green-100"
                >Pertanian Sejahtera</span
              >
            </div>
            <div class="flex items-center space-x-4">
              <button
                id="dark-mode-toggle"
                class="text-white hover:text-green-200 p-2 rounded"
              >
                🌙
              </button>
            </div>
          </div>
        </div>
      </nav>
      <!-- Main Navigation Tabs -->
      <div class="bg-white shadow">
        <div class="max-w-7xl mx-auto">
          <div class="flex overflow-x-auto">
            <button
              class="nav-tab px-6 py-3 text-sm font-medium border-b-2 border-green-500 text-green-600 whitespace-nowrap"
              data-tab="dashboard"
            >
              📊 Dashboard Investor
            </button>
            <button
              class="nav-tab px-6 py-3 text-sm font-medium border-b-2 border-transparent text-gray-500 hover:text-gray-700 whitespace-nowrap"
              data-tab="documentation"
            >
              📸 Dokumentasi
            </button>
            <button
              class="nav-tab px-6 py-3 text-sm font-medium border-b-2 border-transparent text-gray-500 hover:text-gray-700 whitespace-nowrap"
              data-tab="finance"
            >
              💰 Keuangan
            </button>
            <button
              class="nav-tab px-6 py-3 text-sm font-medium border-b-2 border-transparent text-gray-500 hover:text-gray-700 whitespace-nowrap"
              data-tab="inventory"
            >
              📦 Inventory
            </button>
            <button
              class="nav-tab px-6 py-3 text-sm font-medium border-b-2 border-transparent text-gray-500 hover:text-gray-700 whitespace-nowrap"
              data-tab="harvest"
            >
              🌾 Panen
            </button>
            <button
              class="nav-tab px-6 py-3 text-sm font-medium border-b-2 border-transparent text-gray-500 hover:text-gray-700 whitespace-nowrap"
              data-tab="disease"
            >
              🦠 Penyakit
            </button>
            <button
              class="nav-tab px-6 py-3 text-sm font-medium border-b-2 border-transparent text-gray-500 hover:text-gray-700 whitespace-nowrap"
              data-tab="summary"
            >
              📋 Ringkasan
            </button>
          </div>
        </div>
      </div>
      <!-- Main Content -->
      <main class="max-w-7xl mx-auto py-6 px-4">
        <!-- Dashboard Investor Tab -->
        <div id="dashboard-tab" class="tab-content fade-in">
          <div class="mb-6">
            <h2 class="text-2xl font-bold text-gray-900 mb-4">
              Dashboard Investor
            </h2>
            <!-- Investor Summary -->
            <div class="bg-white rounded-lg shadow p-6 mb-6">
              <h3 class="text-lg font-semibold mb-4">Ringkasan Investor</h3>
              <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div class="text-center">
                  <p
                    class="text-2xl font-bold text-green-600"
                    id="total-investors"
                  >
                    0
                  </p>
                  <p class="text-gray-600">Total Investor</p>
                </div>
                <div class="text-center">
                  <p
                    class="text-2xl font-bold text-blue-600"
                    id="total-capital-summary"
                  >
                    Rp 0
                  </p>
                  <p class="text-gray-600">Total Modal</p>
                </div>
                <div class="text-center">
                  <p class="text-2xl font-bold text-purple-600" id="avg-return">
                    0%
                  </p>
                  <p class="text-gray-600">Rata-rata Return</p>
                </div>
              </div>
            </div>
            <!-- Investors List -->
            <div class="bg-white rounded-lg shadow overflow-hidden">
              <div class="px-6 py-4 border-b border-gray-200">
                <h3 class="text-lg font-semibold">Daftar Investor</h3>
              </div>
              <div class="overflow-x-auto">
                <table class="min-w-full divide-y divide-gray-200">
                  <thead class="bg-gray-50">
                    <tr>
                      <th
                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                      >
                        Nama Investor
                      </th>
                      <th
                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                      >
                        Modal Awal
                      </th>
                      <th
                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                      >
                        Persentase
                      </th>
                      <th
                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                      >
                        Status
                      </th>
                      <th
                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                      >
                        Pengembalian
                      </th>
                    </tr>
                  </thead>
                  <tbody
                    id="investors-list"
                    class="bg-white divide-y divide-gray-200"
                  >
                    <!-- Investors will be populated here -->
                  </tbody>
                </table>
              </div>
            </div>
            <!-- Progress Chart -->
            <div class="bg-white rounded-lg shadow p-6 mt-6">
              <h3 class="text-lg font-semibold mb-4">
                Grafik Progress Pengembalian Modal
              </h3>
              <canvas id="progress-chart" width="400" height="200"></canvas>
            </div>
          </div>
        </div>
        <!-- Documentation Tab -->
        <div id="documentation-tab" class="tab-content hidden">
          <div class="mb-6">
            <h2 class="text-2xl font-bold text-gray-900 mb-4">
              Dokumentasi Pertumbuhan
            </h2>
            <!-- Filter Controls -->
            <div class="bg-white rounded-lg shadow p-6 mb-6">
              <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div>
                  <label
                    for="doc-commodity"
                    class="block text-sm font-medium text-gray-700 mb-1"
                    >Komoditas</label
                  >
                  <select
                    id="doc-commodity"
                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500"
                  >
                    <option value="all">Semua Komoditas</option>
                    <option value="timun">Timun</option>
                    <option value="bawang-merah">Bawang Merah</option>
                    <option value="cabai">Cabai</option>
                    <option value="tomat">Tomat</option>
                  </select>
                </div>
                <div>
                  <label
                    for="doc-period"
                    class="block text-sm font-medium text-gray-700 mb-1"
                    >Periode</label
                  >
                  <select
                    id="doc-period"
                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500"
                  >
                    <option value="daily">Harian</option>
                    <option value="weekly">Mingguan</option>
                    <option value="monthly">Bulanan</option>
                  </select>
                </div>
                <div>
                  <label
                    for="doc-date"
                    class="block text-sm font-medium text-gray-700 mb-1"
                    >Tanggal</label
                  >
                  <input
                    type="date"
                    id="doc-date"
                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500"
                  />
                </div>
              </div>
            </div>
            <!-- Navigation Controls -->
            <div class="bg-white rounded-lg shadow p-6 mb-6">
              <div class="flex flex-col space-y-4">
                <!-- Period Navigation Header -->
                <div class="flex items-center justify-between">
                  <h3 class="text-lg font-semibold">Navigasi Periode</h3>
                  <div class="text-sm text-gray-600">
                    <span id="current-period-display">Hari 1</span>
                  </div>
                </div>
                <!-- Daily Navigation -->
                <div id="daily-navigation" class="space-y-3">
                  <div class="flex items-center justify-between">
                    <span class="text-sm font-medium text-gray-700"
                      >Navigasi Harian:</span
                    >
                    <div class="flex items-center space-x-2">
                      <button
                        id="prev-day"
                        class="px-3 py-1 bg-gray-200 text-gray-700 rounded hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-green-500"
                      >
                        ← Hari Sebelumnya
                      </button>
                      <span
                        id="current-day"
                        class="px-3 py-1 bg-green-100 text-green-800 rounded font-medium"
                        >Hari 1</span
                      >
                      <button
                        id="next-day"
                        class="px-3 py-1 bg-gray-200 text-gray-700 rounded hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-green-500"
                      >
                        Hari Selanjutnya →
                      </button>
                    </div>
                  </div>
                  <!-- Quick Day Selection -->
                  <div class="flex flex-wrap gap-2">
                    <span class="text-sm text-gray-600">Lompat ke:</span>
                    <button
                      class="day-quick-nav px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded hover:bg-blue-200"
                      data-day="1"
                    >
                      Hari 1
                    </button>
                    <button
                      class="day-quick-nav px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded hover:bg-blue-200"
                      data-day="7"
                    >
                      Hari 7
                    </button>
                    <button
                      class="day-quick-nav px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded hover:bg-blue-200"
                      data-day="14"
                    >
                      Hari 14
                    </button>
                    <button
                      class="day-quick-nav px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded hover:bg-blue-200"
                      data-day="21"
                    >
                      Hari 21
                    </button>
                    <button
                      class="day-quick-nav px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded hover:bg-blue-200"
                      data-day="30"
                    >
                      Hari 30
                    </button>
                    <button
                      class="day-quick-nav px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded hover:bg-blue-200"
                      data-day="60"
                    >
                      Hari 60
                    </button>
                    <button
                      class="day-quick-nav px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded hover:bg-blue-200"
                      data-day="90"
                    >
                      Hari 90
                    </button>
                  </div>
                </div>
                <!-- Weekly Navigation -->
                <div id="weekly-navigation" class="space-y-3 hidden">
                  <div class="flex items-center justify-between">
                    <span class="text-sm font-medium text-gray-700"
                      >Navigasi Mingguan:</span
                    >
                    <div class="flex items-center space-x-2">
                      <button
                        id="prev-week"
                        class="px-3 py-1 bg-gray-200 text-gray-700 rounded hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-green-500"
                      >
                        ← Minggu Sebelumnya
                      </button>
                      <span
                        id="current-week"
                        class="px-3 py-1 bg-green-100 text-green-800 rounded font-medium"
                        >Minggu 1</span
                      >
                      <button
                        id="next-week"
                        class="px-3 py-1 bg-gray-200 text-gray-700 rounded hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-green-500"
                      >
                        Minggu Selanjutnya →
                      </button>
                    </div>
                  </div>
                  <!-- Quick Week Selection -->
                  <div class="flex flex-wrap gap-2">
                    <span class="text-sm text-gray-600">Lompat ke:</span>
                    <button
                      class="week-quick-nav px-2 py-1 text-xs bg-purple-100 text-purple-800 rounded hover:bg-purple-200"
                      data-week="1"
                    >
                      Minggu 1
                    </button>
                    <button
                      class="week-quick-nav px-2 py-1 text-xs bg-purple-100 text-purple-800 rounded hover:bg-purple-200"
                      data-week="2"
                    >
                      Minggu 2
                    </button>
                    <button
                      class="week-quick-nav px-2 py-1 text-xs bg-purple-100 text-purple-800 rounded hover:bg-purple-200"
                      data-week="4"
                    >
                      Minggu 4
                    </button>
                    <button
                      class="week-quick-nav px-2 py-1 text-xs bg-purple-100 text-purple-800 rounded hover:bg-purple-200"
                      data-week="8"
                    >
                      Minggu 8
                    </button>
                    <button
                      class="week-quick-nav px-2 py-1 text-xs bg-purple-100 text-purple-800 rounded hover:bg-purple-200"
                      data-week="12"
                    >
                      Minggu 12
                    </button>
                  </div>
                </div>
                <!-- Monthly Navigation -->
                <div id="monthly-navigation" class="space-y-3 hidden">
                  <div class="flex items-center justify-between">
                    <span class="text-sm font-medium text-gray-700"
                      >Navigasi Bulanan:</span
                    >
                    <div class="flex items-center space-x-2">
                      <button
                        id="prev-month"
                        class="px-3 py-1 bg-gray-200 text-gray-700 rounded hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-green-500"
                      >
                        ← Bulan Sebelumnya
                      </button>
                      <span
                        id="current-month"
                        class="px-3 py-1 bg-green-100 text-green-800 rounded font-medium"
                        >Bulan 1</span
                      >
                      <button
                        id="next-month"
                        class="px-3 py-1 bg-gray-200 text-gray-700 rounded hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-green-500"
                      >
                        Bulan Selanjutnya →
                      </button>
                    </div>
                  </div>
                  <!-- Quick Month Selection -->
                  <div class="flex flex-wrap gap-2">
                    <span class="text-sm text-gray-600">Lompat ke:</span>
                    <button
                      class="month-quick-nav px-2 py-1 text-xs bg-orange-100 text-orange-800 rounded hover:bg-orange-200"
                      data-month="1"
                    >
                      Bulan 1
                    </button>
                    <button
                      class="month-quick-nav px-2 py-1 text-xs bg-orange-100 text-orange-800 rounded hover:bg-orange-200"
                      data-month="2"
                    >
                      Bulan 2
                    </button>
                    <button
                      class="month-quick-nav px-2 py-1 text-xs bg-orange-100 text-orange-800 rounded hover:bg-orange-200"
                      data-month="3"
                    >
                      Bulan 3
                    </button>
                    <button
                      class="month-quick-nav px-2 py-1 text-xs bg-orange-100 text-orange-800 rounded hover:bg-orange-200"
                      data-month="6"
                    >
                      Bulan 6
                    </button>
                  </div>
                </div>
              </div>
            </div>
            <!-- Documentation Gallery -->
            <div class="bg-white rounded-lg shadow p-6">
              <div class="flex items-center justify-between mb-4">
                <h3 class="text-lg font-semibold">Galeri Dokumentasi</h3>
                <div class="text-sm text-gray-600">
                  <span id="gallery-period-info">Menampilkan: Hari 1</span>
                </div>
              </div>
              <div
                id="documentation-gallery"
                class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"
              >
                <!-- Documentation items will be populated here -->
              </div>
            </div>
          </div>
        </div>
        <!-- Finance Tab -->
        <div id="finance-tab" class="tab-content hidden">
          <div class="mb-6">
            <h2 class="text-2xl font-bold text-gray-900 mb-4">Data Keuangan</h2>
            <!-- Filter Transaksi -->
            <div class="bg-white rounded-lg shadow p-6 mb-6">
              <h3 class="text-lg font-semibold mb-4">Filter Transaksi</h3>
              <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                <div>
                  <label
                    for="filter-transaction-type"
                    class="block text-sm font-medium text-gray-700 mb-1"
                    >Jenis</label
                  >
                  <select
                    id="filter-transaction-type"
                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500"
                  >
                    <option value="all">Semua</option>
                    <option value="income">Pemasukan</option>
                    <option value="expense">Pengeluaran</option>
                  </select>
                </div>
                <div>
                  <label
                    for="filter-transaction-commodity"
                    class="block text-sm font-medium text-gray-700 mb-1"
                    >Komoditas</label
                  >
                  <select
                    id="filter-transaction-commodity"
                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500"
                  >
                    <option value="all">Semua</option>
                    <option value="timun">Timun</option>
                    <option value="bawang-merah">Bawang Merah</option>
                    <option value="cabai">Cabai</option>
                    <option value="tomat">Tomat</option>
                    <option value="general">Umum</option>
                  </select>
                </div>
                <div>
                  <label
                    for="filter-date-from"
                    class="block text-sm font-medium text-gray-700 mb-1"
                    >Dari Tanggal</label
                  >
                  <input
                    type="date"
                    id="filter-date-from"
                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500"
                  />
                </div>
                <div>
                  <label
                    for="filter-date-to"
                    class="block text-sm font-medium text-gray-700 mb-1"
                    >Sampai Tanggal</label
                  >
                  <input
                    type="date"
                    id="filter-date-to"
                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500"
                  />
                </div>
              </div>
            </div>
            <!-- Financial Summary -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
              <div class="bg-white rounded-lg shadow p-6">
                <h3 class="text-lg font-semibold text-green-600">
                  Total Pemasukan
                </h3>
                <p id="total-income" class="text-2xl font-bold text-green-700">
                  Rp 0
                </p>
              </div>
              <div class="bg-white rounded-lg shadow p-6">
                <h3 class="text-lg font-semibold text-red-600">
                  Total Pengeluaran
                </h3>
                <p id="total-expense" class="text-2xl font-bold text-red-700">
                  Rp 0
                </p>
              </div>
              <div class="bg-white rounded-lg shadow p-6">
                <h3 class="text-lg font-semibold text-blue-600">
                  Keuntungan Bersih
                </h3>
                <p id="net-profit" class="text-2xl font-bold text-blue-700">
                  Rp 0
                </p>
              </div>
            </div>
            <!-- Transactions List -->
            <div class="bg-white rounded-lg shadow overflow-hidden">
              <div class="px-6 py-4 border-b border-gray-200">
                <h3 class="text-lg font-semibold">Riwayat Transaksi</h3>
              </div>
              <div class="overflow-x-auto">
                <table class="min-w-full divide-y divide-gray-200">
                  <thead class="bg-gray-50">
                    <tr>
                      <th
                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                      >
                        Tanggal
                      </th>
                      <th
                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                      >
                        Jenis
                      </th>
                      <th
                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                      >
                        Komoditas
                      </th>
                      <th
                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                      >
                        Jumlah
                      </th>
                      <th
                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                      >
                        Keterangan
                      </th>
                    </tr>
                  </thead>
                  <tbody
                    id="transactions-list"
                    class="bg-white divide-y divide-gray-200"
                  >
                    <!-- Transactions will be populated here -->
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
        <!-- Inventory Tab -->
        <div id="inventory-tab" class="tab-content hidden">
          <div class="mb-6">
            <h2 class="text-2xl font-bold text-gray-900 mb-4">
              Inventory Barang &amp; Stok
            </h2>
            <!-- Filter Inventory -->
            <div class="bg-white rounded-lg shadow p-6 mb-6">
              <h3 class="text-lg font-semibold mb-4">Filter Inventory</h3>
              <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div>
                  <label
                    for="filter-inventory-commodity"
                    class="block text-sm font-medium text-gray-700 mb-1"
                    >Komoditas</label
                  >
                  <select
                    id="filter-inventory-commodity"
                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500"
                  >
                    <option value="all">Semua</option>
                    <option value="general">Umum</option>
                    <option value="timun">Timun</option>
                    <option value="bawang-merah">Bawang Merah</option>
                    <option value="cabai">Cabai</option>
                    <option value="tomat">Tomat</option>
                  </select>
                </div>
                <div>
                  <label
                    for="filter-inventory-status"
                    class="block text-sm font-medium text-gray-700 mb-1"
                    >Status Stok</label
                  >
                  <select
                    id="filter-inventory-status"
                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500"
                  >
                    <option value="all">Semua</option>
                    <option value="available">Tersedia</option>
                    <option value="low">Menipis</option>
                  </select>
                </div>
                <div>
                  <label
                    for="filter-inventory-search"
                    class="block text-sm font-medium text-gray-700 mb-1"
                    >Cari Barang</label
                  >
                  <input
                    type="text"
                    id="filter-inventory-search"
                    placeholder="Nama barang..."
                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500"
                  />
                </div>
              </div>
            </div>
            <!-- Low Stock Notifications -->
            <div id="low-stock-notifications" class="mb-6 hidden">
              <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
                <h3 class="text-lg font-semibold text-yellow-800 mb-2">
                  ⚠️ Stok Menipis
                </h3>
                <div id="low-stock-list" class="text-yellow-700">
                  <!-- Low stock items will be populated here -->
                </div>
              </div>
            </div>
            <!-- Inventory List -->
            <div class="bg-white rounded-lg shadow overflow-hidden">
              <div class="px-6 py-4 border-b border-gray-200">
                <h3 class="text-lg font-semibold">Daftar Inventory</h3>
              </div>
              <div class="overflow-x-auto">
                <table class="min-w-full divide-y divide-gray-200">
                  <thead class="bg-gray-50">
                    <tr>
                      <th
                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                      >
                        Nama Barang
                      </th>
                      <th
                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                      >
                        Jumlah
                      </th>
                      <th
                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                      >
                        Satuan
                      </th>
                      <th
                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                      >
                        Tanggal
                      </th>
                      <th
                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                      >
                        Komoditas
                      </th>
                      <th
                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                      >
                        Status
                      </th>
                    </tr>
                  </thead>
                  <tbody
                    id="inventory-list"
                    class="bg-white divide-y divide-gray-200"
                  >
                    <!-- Inventory items will be populated here -->
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
        <!-- Harvest Tab -->
        <div id="harvest-tab" class="tab-content hidden">
          <div class="mb-6">
            <h2 class="text-2xl font-bold text-gray-900 mb-4">Data Panen</h2>
            <!-- Countdown to Next Harvest -->
            <div class="bg-white rounded-lg shadow p-6 mb-6">
              <h3 class="text-lg font-semibold mb-4">
                ⏰ Countdown Panen Terdekat
              </h3>
              <div id="harvest-countdown" class="text-center">
                <div
                  class="text-3xl font-bold text-green-600"
                  id="countdown-display"
                >
                  --
                </div>
                <div class="text-gray-600" id="countdown-commodity">
                  Belum ada jadwal panen
                </div>
              </div>
            </div>
            <!-- Filter Panen -->
            <div class="bg-white rounded-lg shadow p-6 mb-6">
              <h3 class="text-lg font-semibold mb-4">Filter Data Panen</h3>
              <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div>
                  <label
                    for="filter-harvest-commodity"
                    class="block text-sm font-medium text-gray-700 mb-1"
                    >Komoditas</label
                  >
                  <select
                    id="filter-harvest-commodity"
                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500"
                  >
                    <option value="all">Semua</option>
                    <option value="timun">Timun</option>
                    <option value="bawang-merah">Bawang Merah</option>
                    <option value="cabai">Cabai</option>
                    <option value="tomat">Tomat</option>
                  </select>
                </div>
                <div>
                  <label
                    for="filter-harvest-status"
                    class="block text-sm font-medium text-gray-700 mb-1"
                    >Status</label
                  >
                  <select
                    id="filter-harvest-status"
                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500"
                  >
                    <option value="all">Semua</option>
                    <option value="scheduled">Terjadwal</option>
                    <option value="completed">Selesai</option>
                  </select>
                </div>
                <div>
                  <label
                    for="filter-harvest-year"
                    class="block text-sm font-medium text-gray-700 mb-1"
                    >Tahun</label
                  >
                  <select
                    id="filter-harvest-year"
                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500"
                  >
                    <option value="all">Semua</option>
                    <option value="2024">2024</option>
                    <option value="2023">2023</option>
                  </select>
                </div>
              </div>
            </div>
            <!-- Harvest List -->
            <div class="bg-white rounded-lg shadow overflow-hidden">
              <div class="px-6 py-4 border-b border-gray-200">
                <h3 class="text-lg font-semibold">Jadwal &amp; Hasil Panen</h3>
              </div>
              <div class="overflow-x-auto">
                <table class="min-w-full divide-y divide-gray-200">
                  <thead class="bg-gray-50">
                    <tr>
                      <th
                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                      >
                        Komoditas
                      </th>
                      <th
                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                      >
                        Tanggal Panen
                      </th>
                      <th
                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                      >
                        Target (kg)
                      </th>
                      <th
                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                      >
                        Aktual (kg)
                      </th>
                      <th
                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                      >
                        Keberhasilan
                      </th>
                      <th
                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                      >
                        Status
                      </th>
                    </tr>
                  </thead>
                  <tbody
                    id="harvest-list"
                    class="bg-white divide-y divide-gray-200"
                  >
                    <!-- Harvest schedules will be populated here -->
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
        <!-- Disease Tab -->
        <div id="disease-tab" class="tab-content hidden">
          <div class="mb-6">
            <h2 class="text-2xl font-bold text-gray-900 mb-4">
              Penyakit Tanaman
            </h2>
            <!-- Statistik Penyakit -->
            <div class="bg-white rounded-lg shadow p-6 mb-6">
              <h3 class="text-lg font-semibold mb-4">Statistik Penyakit</h3>
              <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                <div class="text-center">
                  <p
                    class="text-2xl font-bold text-red-600"
                    id="total-diseases"
                  >
                    0
                  </p>
                  <p class="text-gray-600">Total Penyakit</p>
                </div>
                <div class="text-center">
                  <p
                    class="text-2xl font-bold text-orange-600"
                    id="active-diseases-count"
                  >
                    0
                  </p>
                  <p class="text-gray-600">Aktif</p>
                </div>
                <div class="text-center">
                  <p
                    class="text-2xl font-bold text-yellow-600"
                    id="treated-diseases-count"
                  >
                    0
                  </p>
                  <p class="text-gray-600">Ditangani</p>
                </div>
                <div class="text-center">
                  <p
                    class="text-2xl font-bold text-green-600"
                    id="resolved-diseases-count"
                  >
                    0
                  </p>
                  <p class="text-gray-600">Selesai</p>
                </div>
              </div>
            </div>
            <!-- Disease Filter -->
            <div class="bg-white rounded-lg shadow p-6 mb-6">
              <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                  <label
                    for="disease-filter-commodity"
                    class="block text-sm font-medium text-gray-700 mb-1"
                    >Filter Komoditas</label
                  >
                  <select
                    id="disease-filter-commodity"
                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500"
                  >
                    <option value="all">Semua Komoditas</option>
                    <option value="timun">Timun</option>
                    <option value="bawang-merah">Bawang Merah</option>
                    <option value="cabai">Cabai</option>
                    <option value="tomat">Tomat</option>
                  </select>
                </div>
                <div>
                  <label
                    for="disease-filter-status"
                    class="block text-sm font-medium text-gray-700 mb-1"
                    >Filter Status</label
                  >
                  <select
                    id="disease-filter-status"
                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500"
                  >
                    <option value="all">Semua Status</option>
                    <option value="active">Aktif</option>
                    <option value="treated">Ditangani</option>
                    <option value="resolved">Selesai</option>
                  </select>
                </div>
              </div>
            </div>
            <!-- Disease List -->
            <div class="bg-white rounded-lg shadow overflow-hidden">
              <div class="px-6 py-4 border-b border-gray-200">
                <h3 class="text-lg font-semibold">Database Penyakit Tanaman</h3>
              </div>
              <div class="overflow-x-auto">
                <table class="min-w-full divide-y divide-gray-200">
                  <thead class="bg-gray-50">
                    <tr>
                      <th
                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                      >
                        Nama Penyakit
                      </th>
                      <th
                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                      >
                        Komoditas
                      </th>
                      <th
                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                      >
                        Gejala
                      </th>
                      <th
                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                      >
                        Keparahan
                      </th>
                      <th
                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                      >
                        Status
                      </th>
                    </tr>
                  </thead>
                  <tbody
                    id="disease-list"
                    class="bg-white divide-y divide-gray-200"
                  >
                    <!-- Disease records will be populated here -->
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
        <!-- Summary Tab -->
        <div id="summary-tab" class="tab-content hidden">
          <div class="mb-6">
            <h2 class="text-2xl font-bold text-gray-900 mb-4">
              Ringkasan Akhir Data
            </h2>
            <!-- View Toggle -->
            <div class="bg-white rounded-lg shadow p-6 mb-6">
              <div class="flex space-x-4">
                <button
                  id="summary-all"
                  class="px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500"
                >
                  Total Keseluruhan
                </button>
                <select
                  id="summary-commodity"
                  class="px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500"
                >
                  <option value="">Pilih Komoditas Spesifik</option>
                  <option value="timun">Timun</option>
                  <option value="bawang-merah">Bawang Merah</option>
                  <option value="cabai">Cabai</option>
                  <option value="tomat">Tomat</option>
                </select>
              </div>
            </div>
            <!-- Summary Cards -->
            <div
              class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-6"
            >
              <div class="bg-white rounded-lg shadow p-6">
                <h3 class="text-lg font-semibold text-blue-600">
                  💰 Total Modal
                </h3>
                <p
                  id="summary-total-capital"
                  class="text-2xl font-bold text-blue-700"
                >
                  Rp 0
                </p>
              </div>
              <div class="bg-white rounded-lg shadow p-6">
                <h3 class="text-lg font-semibold text-green-600">
                  📈 Total Keuntungan
                </h3>
                <p
                  id="summary-total-profit"
                  class="text-2xl font-bold text-green-700"
                >
                  Rp 0
                </p>
              </div>
              <div class="bg-white rounded-lg shadow p-6">
                <h3 class="text-lg font-semibold text-red-600">
                  📉 Total Pengeluaran
                </h3>
                <p
                  id="summary-total-expense"
                  class="text-2xl font-bold text-red-700"
                >
                  Rp 0
                </p>
              </div>
              <div class="bg-white rounded-lg shadow p-6">
                <h3 class="text-lg font-semibold text-purple-600">
                  📊 Persentase Pengembalian
                </h3>
                <p
                  id="summary-return-percentage"
                  class="text-2xl font-bold text-purple-700"
                >
                  0%
                </p>
              </div>
              <div class="bg-white rounded-lg shadow p-6">
                <h3 class="text-lg font-semibold text-orange-600">
                  🦠 Penyakit Aktif
                </h3>
                <p
                  id="summary-active-diseases"
                  class="text-2xl font-bold text-orange-700"
                >
                  0
                </p>
              </div>
              <div class="bg-white rounded-lg shadow p-6">
                <h3 class="text-lg font-semibold text-yellow-600">
                  🌾 Panen Terdekat
                </h3>
                <p
                  id="summary-next-harvest"
                  class="text-lg font-bold text-yellow-700"
                >
                  -
                </p>
              </div>
            </div>
            <!-- Detailed Summary Chart -->
            <div class="bg-white rounded-lg shadow p-6">
              <h3 class="text-lg font-semibold mb-4">
                Grafik Ringkasan Keuangan
              </h3>
              <canvas id="summary-chart" width="400" height="200"></canvas>
            </div>
          </div>
        </div>
      </main>
      <!-- Notification Toast -->
      <div
        id="notification"
        class="fixed top-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg notification hidden"
      >
        <span id="notification-message">Berhasil!</span>
      </div>
    </div>
    <script>
      // Global variables
      let allData = [];
      let isDarkMode = false;
      let progressChart = null;
      let summaryChart = null;
      let currentDay = 1;
      let currentWeek = 1;
      let currentMonth = 1;
      let currentPeriodType = "daily";

      // Default configuration
      const defaultConfig = {
        app_title: "Sistem Manajemen Pertanian",
        farm_name: "Pertanian Sejahtera",
        background_color: "#f9fafb",
        surface_color: "#ffffff",
        text_color: "#111827",
        primary_color: "#059669",
        secondary_color: "#6b7280",
      };

      // Data handler for SDK
      const dataHandler = {
        onDataChanged(data) {
          allData = data;
          updateAllDisplays();
          updateFinancialSummary();
          updateInventoryDisplay();
          updateHarvestDisplay();
          updateDiseaseDisplay();
          updateSummaryDisplay();
          updateProgressChart();
          updateSummaryChart();
          checkLowStock();
          updateHarvestCountdown();
        },
      };

      // Initialize SDK and app
      async function initializeApp() {
        if (window.dataSdk) {
          const result = await window.dataSdk.init(dataHandler);
          if (!result.isOk) {
            console.error("Failed to initialize data SDK");
          }
        }

        if (window.elementSdk) {
          window.elementSdk.init({
            defaultConfig,
            onConfigChange: async (config) => {
              document.getElementById("app-title").textContent =
                config.app_title || defaultConfig.app_title;
              document.getElementById("farm-name").textContent =
                config.farm_name || defaultConfig.farm_name;

              // Apply colors
              document.body.style.backgroundColor =
                config.background_color || defaultConfig.background_color;

              const surfaces = document.querySelectorAll(".bg-white");
              surfaces.forEach((el) => {
                el.style.backgroundColor =
                  config.surface_color || defaultConfig.surface_color;
              });

              const textElements = document.querySelectorAll(
                ".text-gray-900, .text-gray-700, .text-gray-600"
              );
              textElements.forEach((el) => {
                el.style.color = config.text_color || defaultConfig.text_color;
              });

              const primaryElements = document.querySelectorAll(
                ".bg-green-600, .text-green-600, .border-green-500"
              );
              primaryElements.forEach((el) => {
                if (el.classList.contains("bg-green-600")) {
                  el.style.backgroundColor =
                    config.primary_color || defaultConfig.primary_color;
                }
                if (el.classList.contains("text-green-600")) {
                  el.style.color =
                    config.primary_color || defaultConfig.primary_color;
                }
                if (el.classList.contains("border-green-500")) {
                  el.style.borderColor =
                    config.primary_color || defaultConfig.primary_color;
                }
              });
            },
            mapToCapabilities: (config) => ({
              recolorables: [
                {
                  get: () =>
                    config.background_color || defaultConfig.background_color,
                  set: (value) => {
                    window.elementSdk.setConfig({ background_color: value });
                  },
                },
                {
                  get: () =>
                    config.surface_color || defaultConfig.surface_color,
                  set: (value) => {
                    window.elementSdk.setConfig({ surface_color: value });
                  },
                },
                {
                  get: () => config.text_color || defaultConfig.text_color,
                  set: (value) => {
                    window.elementSdk.setConfig({ text_color: value });
                  },
                },
                {
                  get: () =>
                    config.primary_color || defaultConfig.primary_color,
                  set: (value) => {
                    window.elementSdk.setConfig({ primary_color: value });
                  },
                },
                {
                  get: () =>
                    config.secondary_color || defaultConfig.secondary_color,
                  set: (value) => {
                    window.elementSdk.setConfig({ secondary_color: value });
                  },
                },
              ],
              borderables: [],
              fontEditable: undefined,
              fontSizeable: undefined,
            }),
            mapToEditPanelValues: (config) =>
              new Map([
                ["app_title", config.app_title || defaultConfig.app_title],
                ["farm_name", config.farm_name || defaultConfig.farm_name],
              ]),
          });
        }

        setupEventListeners();
        initializeCharts();
      }

      // Setup event listeners
      function setupEventListeners() {
        // Tab navigation
        document.querySelectorAll(".nav-tab").forEach((tab) => {
          tab.addEventListener("click", (e) => {
            const tabName = e.target.dataset.tab;
            switchTab(tabName);
          });
        });

        // Dark mode toggle
        document
          .getElementById("dark-mode-toggle")
          .addEventListener("click", toggleDarkMode);

        // Filter changes
        document
          .getElementById("filter-transaction-type")
          .addEventListener("change", updateTransactionDisplay);
        document
          .getElementById("filter-transaction-commodity")
          .addEventListener("change", updateTransactionDisplay);
        document
          .getElementById("filter-date-from")
          .addEventListener("change", updateTransactionDisplay);
        document
          .getElementById("filter-date-to")
          .addEventListener("change", updateTransactionDisplay);

        document
          .getElementById("filter-inventory-commodity")
          .addEventListener("change", updateInventoryDisplay);
        document
          .getElementById("filter-inventory-status")
          .addEventListener("change", updateInventoryDisplay);
        document
          .getElementById("filter-inventory-search")
          .addEventListener("input", updateInventoryDisplay);

        document
          .getElementById("filter-harvest-commodity")
          .addEventListener("change", updateHarvestDisplay);
        document
          .getElementById("filter-harvest-status")
          .addEventListener("change", updateHarvestDisplay);
        document
          .getElementById("filter-harvest-year")
          .addEventListener("change", updateHarvestDisplay);

        document
          .getElementById("disease-filter-commodity")
          .addEventListener("change", updateDiseaseDisplay);
        document
          .getElementById("disease-filter-status")
          .addEventListener("change", updateDiseaseDisplay);
        document
          .getElementById("summary-commodity")
          .addEventListener("change", updateSummaryDisplay);
        document.getElementById("summary-all").addEventListener("click", () => {
          document.getElementById("summary-commodity").value = "";
          updateSummaryDisplay();
        });

        // Timer controls
        document
          .getElementById("planting-control")
          .addEventListener("click", togglePlantingTimer);

        // Documentation navigation
        setupDocumentationNavigation();

        // Start all timers
        startAllTimers();
      }

      // Tab switching
      function switchTab(tabName) {
        // Update tab buttons
        document.querySelectorAll(".nav-tab").forEach((tab) => {
          tab.classList.remove("border-green-500", "text-green-600");
          tab.classList.add("border-transparent", "text-gray-500");
        });

        document
          .querySelector(`[data-tab="${tabName}"]`)
          .classList.remove("border-transparent", "text-gray-500");
        document
          .querySelector(`[data-tab="${tabName}"]`)
          .classList.add("border-green-500", "text-green-600");

        // Update content
        document.querySelectorAll(".tab-content").forEach((content) => {
          content.classList.add("hidden");
        });

        document.getElementById(`${tabName}-tab`).classList.remove("hidden");
      }

      // Dark mode toggle
      function toggleDarkMode() {
        isDarkMode = !isDarkMode;
        document.body.classList.toggle("dark", isDarkMode);
        document.getElementById("dark-mode-toggle").textContent = isDarkMode
          ? "☀️"
          : "🌙";
      }

      // Show notification
      function showNotification(message, type = "success") {
        const notification = document.getElementById("notification");
        const messageEl = document.getElementById("notification-message");

        messageEl.textContent = message;
        notification.className = `fixed top-4 right-4 px-6 py-3 rounded-lg shadow-lg notification ${
          type === "success" ? "bg-green-500" : "bg-red-500"
        } text-white`;

        notification.classList.remove("hidden");

        setTimeout(() => {
          notification.classList.add("hidden");
        }, 3000);
      }

      // Generate sample data for demonstration
      function generateSampleData() {
        const sampleData = [
          // Sample investors
          {
            __backendId: "inv1",
            type: "investor",
            data: JSON.stringify({
              name: "Budi Santoso",
              initialCapital: 50000000,
              ownershipPercentage: 40,
            }),
            timestamp: "2024-01-15T00:00:00.000Z",
            commodity: "general",
            category: "investor",
            amount: 50000000,
            status: "active",
          },
          {
            __backendId: "inv2",
            type: "investor",
            data: JSON.stringify({
              name: "Siti Rahayu",
              initialCapital: 30000000,
              ownershipPercentage: 25,
            }),
            timestamp: "2024-01-20T00:00:00.000Z",
            commodity: "general",
            category: "investor",
            amount: 30000000,
            status: "active",
          },
          // Sample transactions
          {
            __backendId: "trans1",
            type: "transaction",
            data: JSON.stringify({
              transactionType: "expense",
              description: "Pembelian bibit timun",
            }),
            timestamp: "2024-02-01T00:00:00.000Z",
            commodity: "timun",
            category: "expense",
            amount: 2500000,
            status: "completed",
          },
          {
            __backendId: "trans2",
            type: "transaction",
            data: JSON.stringify({
              transactionType: "income",
              description: "Penjualan hasil panen bawang merah",
            }),
            timestamp: "2024-02-15T00:00:00.000Z",
            commodity: "bawang-merah",
            category: "income",
            amount: 15000000,
            status: "completed",
          },
          // Sample inventory
          {
            __backendId: "inv_item1",
            type: "inventory",
            data: JSON.stringify({
              name: "Pupuk NPK",
              quantity: 50,
              unit: "kg",
            }),
            timestamp: "2024-01-25T00:00:00.000Z",
            commodity: "general",
            category: "inventory",
            amount: 50,
            status: "available",
          },
          {
            __backendId: "inv_item2",
            type: "inventory",
            data: JSON.stringify({
              name: "Pestisida Organik",
              quantity: 5,
              unit: "liter",
            }),
            timestamp: "2024-02-01T00:00:00.000Z",
            commodity: "timun",
            category: "inventory",
            amount: 5,
            status: "available",
          },
          // Sample harvest
          {
            __backendId: "harvest1",
            type: "harvest",
            data: JSON.stringify({
              harvestDate: "2024-03-15",
              targetYield: 500,
              actualYield: 480,
            }),
            timestamp: "2024-01-15T00:00:00.000Z",
            commodity: "timun",
            category: "harvest",
            amount: 500,
            status: "completed",
          },
          {
            __backendId: "harvest2",
            type: "harvest",
            data: JSON.stringify({
              harvestDate: "2024-04-20",
              targetYield: 300,
              actualYield: 0,
            }),
            timestamp: "2024-02-01T00:00:00.000Z",
            commodity: "cabai",
            category: "harvest",
            amount: 300,
            status: "scheduled",
          },
          // Sample diseases
          {
            __backendId: "disease1",
            type: "disease",
            data: JSON.stringify({
              name: "Layu Fusarium",
              symptoms: "Daun menguning dan layu",
              cause: "Jamur Fusarium oxysporum",
              treatment: "Aplikasi fungisida dan perbaikan drainase",
              severity: "medium",
            }),
            timestamp: "2024-02-10T00:00:00.000Z",
            commodity: "tomat",
            category: "disease",
            amount: 1,
            status: "treated",
          },
        ];

        return sampleData;
      }

      // Update all displays
      function updateAllDisplays() {
        updateInvestorDisplay();
        updateTransactionDisplay();
      }

      // Update investor display
      function updateInvestorDisplay() {
        const investorsList = document.getElementById("investors-list");
        const investors = allData.filter((item) => item.type === "investor");

        // Update summary
        const totalInvestors = investors.length;
        const totalCapital = investors.reduce(
          (sum, inv) => sum + inv.amount,
          0
        );
        const avgReturn =
          investors.length > 0 ? (Math.random() * 15).toFixed(2) : 0;

        document.getElementById("total-investors").textContent = totalInvestors;
        document.getElementById(
          "total-capital-summary"
        ).textContent = `Rp ${totalCapital.toLocaleString()}`;
        document.getElementById("avg-return").textContent = `${avgReturn}%`;

        investorsList.innerHTML = "";

        investors.forEach((investor) => {
          const data = JSON.parse(investor.data);
          const row = document.createElement("tr");

          // Calculate return percentage (simplified)
          const returnPercentage = (Math.random() * 20 - 5).toFixed(2);
          const status = returnPercentage >= 0 ? "Untung" : "Rugi";
          const statusClass =
            returnPercentage >= 0 ? "text-green-600" : "text-red-600";

          row.innerHTML = `
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${
                      data.name
                    }</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">Rp ${data.initialCapital.toLocaleString()}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${
                      data.ownershipPercentage
                    }%</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm ${statusClass}">${status}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm ${statusClass}">${returnPercentage}%</td>
                `;

          investorsList.appendChild(row);
        });
      }

      // Update transaction display
      function updateTransactionDisplay() {
        const transactionsList = document.getElementById("transactions-list");
        let transactions = allData.filter(
          (item) => item.type === "transaction"
        );

        // Apply filters
        const typeFilter = document.getElementById(
          "filter-transaction-type"
        )?.value;
        const commodityFilter = document.getElementById(
          "filter-transaction-commodity"
        )?.value;
        const dateFromFilter =
          document.getElementById("filter-date-from")?.value;
        const dateToFilter = document.getElementById("filter-date-to")?.value;

        if (typeFilter && typeFilter !== "all") {
          transactions = transactions.filter((t) => t.category === typeFilter);
        }

        if (commodityFilter && commodityFilter !== "all") {
          transactions = transactions.filter(
            (t) => t.commodity === commodityFilter
          );
        }

        if (dateFromFilter) {
          transactions = transactions.filter(
            (t) => new Date(t.timestamp) >= new Date(dateFromFilter)
          );
        }

        if (dateToFilter) {
          transactions = transactions.filter(
            (t) => new Date(t.timestamp) <= new Date(dateToFilter)
          );
        }

        transactionsList.innerHTML = "";

        transactions.forEach((transaction) => {
          const data = JSON.parse(transaction.data);
          const row = document.createElement("tr");

          const typeClass =
            transaction.category === "income"
              ? "text-green-600"
              : "text-red-600";
          const typeText =
            transaction.category === "income" ? "Pemasukan" : "Pengeluaran";

          row.innerHTML = `
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${new Date(
                      transaction.timestamp
                    ).toLocaleDateString()}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm ${typeClass}">${typeText}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${
                      transaction.commodity
                    }</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">Rp ${transaction.amount.toLocaleString()}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${
                      data.description
                    }</td>
                `;

          transactionsList.appendChild(row);
        });
      }

      // Update financial summary
      function updateFinancialSummary() {
        const transactions = allData.filter(
          (item) => item.type === "transaction"
        );

        const totalIncome = transactions
          .filter((t) => t.category === "income")
          .reduce((sum, t) => sum + t.amount, 0);

        const totalExpense = transactions
          .filter((t) => t.category === "expense")
          .reduce((sum, t) => sum + t.amount, 0);

        const netProfit = totalIncome - totalExpense;

        document.getElementById(
          "total-income"
        ).textContent = `Rp ${totalIncome.toLocaleString()}`;
        document.getElementById(
          "total-expense"
        ).textContent = `Rp ${totalExpense.toLocaleString()}`;
        document.getElementById(
          "net-profit"
        ).textContent = `Rp ${netProfit.toLocaleString()}`;
      }

      // Update inventory display
      function updateInventoryDisplay() {
        const inventoryList = document.getElementById("inventory-list");
        let inventoryItems = allData.filter(
          (item) => item.type === "inventory"
        );

        // Apply filters
        const commodityFilter = document.getElementById(
          "filter-inventory-commodity"
        )?.value;
        const statusFilter = document.getElementById(
          "filter-inventory-status"
        )?.value;
        const searchFilter = document
          .getElementById("filter-inventory-search")
          ?.value?.toLowerCase();

        if (commodityFilter && commodityFilter !== "all") {
          inventoryItems = inventoryItems.filter(
            (item) => item.commodity === commodityFilter
          );
        }

        if (statusFilter && statusFilter !== "all") {
          inventoryItems = inventoryItems.filter((item) => {
            const data = JSON.parse(item.data);
            const isLowStock = data.quantity < 10;
            return statusFilter === "low" ? isLowStock : !isLowStock;
          });
        }

        if (searchFilter) {
          inventoryItems = inventoryItems.filter((item) => {
            const data = JSON.parse(item.data);
            return data.name.toLowerCase().includes(searchFilter);
          });
        }

        inventoryList.innerHTML = "";

        inventoryItems.forEach((item) => {
          const data = JSON.parse(item.data);
          const row = document.createElement("tr");

          const stockStatus = data.quantity < 10 ? "Menipis" : "Tersedia";
          const statusClass =
            data.quantity < 10 ? "text-red-600" : "text-green-600";

          row.innerHTML = `
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${
                      data.name
                    }</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${
                      data.quantity
                    }</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${
                      data.unit
                    }</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${new Date(
                      item.timestamp
                    ).toLocaleDateString()}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${
                      item.commodity
                    }</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm ${statusClass}">${stockStatus}</td>
                `;

          inventoryList.appendChild(row);
        });
      }

      // Update harvest display
      function updateHarvestDisplay() {
        const harvestList = document.getElementById("harvest-list");
        let harvestItems = allData.filter((item) => item.type === "harvest");

        // Apply filters
        const commodityFilter = document.getElementById(
          "filter-harvest-commodity"
        )?.value;
        const statusFilter = document.getElementById(
          "filter-harvest-status"
        )?.value;
        const yearFilter = document.getElementById(
          "filter-harvest-year"
        )?.value;

        if (commodityFilter && commodityFilter !== "all") {
          harvestItems = harvestItems.filter(
            (item) => item.commodity === commodityFilter
          );
        }

        if (statusFilter && statusFilter !== "all") {
          harvestItems = harvestItems.filter((item) => {
            const data = JSON.parse(item.data);
            const harvestDate = new Date(data.harvestDate);
            const today = new Date();
            const isScheduled = harvestDate > today;
            return statusFilter === "scheduled" ? isScheduled : !isScheduled;
          });
        }

        if (yearFilter && yearFilter !== "all") {
          harvestItems = harvestItems.filter((item) => {
            const data = JSON.parse(item.data);
            const harvestYear = new Date(data.harvestDate)
              .getFullYear()
              .toString();
            return harvestYear === yearFilter;
          });
        }

        harvestList.innerHTML = "";

        harvestItems.forEach((item) => {
          const data = JSON.parse(item.data);
          const row = document.createElement("tr");

          const successRate =
            data.actualYield > 0
              ? ((data.actualYield / data.targetYield) * 100).toFixed(1)
              : 0;
          const harvestDate = new Date(data.harvestDate);
          const today = new Date();
          const status = harvestDate > today ? "Terjadwal" : "Selesai";

          row.innerHTML = `
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${
                      item.commodity
                    }</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${new Date(
                      data.harvestDate
                    ).toLocaleDateString()}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${
                      data.targetYield
                    }</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${
                      data.actualYield
                    }</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${successRate}%</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${status}</td>
                `;

          harvestList.appendChild(row);
        });
      }

      // Update disease display
      function updateDiseaseDisplay() {
        const diseaseList = document.getElementById("disease-list");
        const commodityFilter = document.getElementById(
          "disease-filter-commodity"
        ).value;
        const statusFilter = document.getElementById(
          "disease-filter-status"
        ).value;

        let diseaseItems = allData.filter((item) => item.type === "disease");

        if (commodityFilter !== "all") {
          diseaseItems = diseaseItems.filter(
            (item) => item.commodity === commodityFilter
          );
        }

        if (statusFilter !== "all") {
          diseaseItems = diseaseItems.filter(
            (item) => item.status === statusFilter
          );
        }

        // Update disease statistics
        const totalDiseases = diseaseItems.length;
        const activeDiseases = diseaseItems.filter(
          (item) => item.status === "active"
        ).length;
        const treatedDiseases = diseaseItems.filter(
          (item) => item.status === "treated"
        ).length;
        const resolvedDiseases = diseaseItems.filter(
          (item) => item.status === "resolved"
        ).length;

        document.getElementById("total-diseases").textContent = totalDiseases;
        document.getElementById("active-diseases-count").textContent =
          activeDiseases;
        document.getElementById("treated-diseases-count").textContent =
          treatedDiseases;
        document.getElementById("resolved-diseases-count").textContent =
          resolvedDiseases;

        diseaseList.innerHTML = "";

        diseaseItems.forEach((item) => {
          const data = JSON.parse(item.data);
          const row = document.createElement("tr");

          const severityClass = {
            low: "text-yellow-600",
            medium: "text-orange-600",
            high: "text-red-600",
          }[data.severity];

          const severityText = {
            low: "Ringan",
            medium: "Sedang",
            high: "Berat",
          }[data.severity];

          const statusText = {
            active: "Aktif",
            treated: "Ditangani",
            resolved: "Selesai",
          }[item.status];

          row.innerHTML = `
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${data.name}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${item.commodity}</td>
                    <td class="px-6 py-4 text-sm text-gray-500 max-w-xs truncate">${data.symptoms}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm ${severityClass}">${severityText}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${statusText}</td>
                `;

          diseaseList.appendChild(row);
        });
      }

      // Update summary display
      function updateSummaryDisplay() {
        const selectedCommodity =
          document.getElementById("summary-commodity").value;

        let filteredData = allData;
        if (selectedCommodity) {
          filteredData = allData.filter(
            (item) => item.commodity === selectedCommodity
          );
        }

        // Calculate totals
        const investors = allData.filter((item) => item.type === "investor");
        const totalCapital = investors.reduce(
          (sum, inv) => sum + inv.amount,
          0
        );

        const transactions = filteredData.filter(
          (item) => item.type === "transaction"
        );
        const totalIncome = transactions
          .filter((t) => t.category === "income")
          .reduce((sum, t) => sum + t.amount, 0);
        const totalExpense = transactions
          .filter((t) => t.category === "expense")
          .reduce((sum, t) => sum + t.amount, 0);
        const totalProfit = totalIncome - totalExpense;

        const returnPercentage =
          totalCapital > 0
            ? ((totalProfit / totalCapital) * 100).toFixed(2)
            : 0;

        const activeDiseases = filteredData.filter(
          (item) => item.type === "disease" && item.status === "active"
        ).length;

        // Find next harvest
        const harvestItems = filteredData.filter(
          (item) => item.type === "harvest"
        );
        const upcomingHarvests = harvestItems
          .map((item) => {
            const data = JSON.parse(item.data);
            return { ...item, harvestDate: new Date(data.harvestDate) };
          })
          .filter((item) => item.harvestDate > new Date())
          .sort((a, b) => a.harvestDate - b.harvestDate);

        const nextHarvest =
          upcomingHarvests.length > 0
            ? `${
                upcomingHarvests[0].commodity
              } - ${upcomingHarvests[0].harvestDate.toLocaleDateString()}`
            : "Tidak ada";

        // Update display
        document.getElementById(
          "summary-total-capital"
        ).textContent = `Rp ${totalCapital.toLocaleString()}`;
        document.getElementById(
          "summary-total-profit"
        ).textContent = `Rp ${totalProfit.toLocaleString()}`;
        document.getElementById(
          "summary-total-expense"
        ).textContent = `Rp ${totalExpense.toLocaleString()}`;
        document.getElementById(
          "summary-return-percentage"
        ).textContent = `${returnPercentage}%`;
        document.getElementById("summary-active-diseases").textContent =
          activeDiseases;
        document.getElementById("summary-next-harvest").textContent =
          nextHarvest;
      }

      // Check low stock
      function checkLowStock() {
        const inventoryItems = allData.filter(
          (item) => item.type === "inventory"
        );
        const lowStockItems = inventoryItems.filter((item) => {
          const data = JSON.parse(item.data);
          return data.quantity < 10;
        });

        const notification = document.getElementById("low-stock-notifications");
        const lowStockList = document.getElementById("low-stock-list");

        if (lowStockItems.length > 0) {
          notification.classList.remove("hidden");
          lowStockList.innerHTML = lowStockItems
            .map((item) => {
              const data = JSON.parse(item.data);
              return `<p>• ${data.name}: ${data.quantity} ${data.unit}</p>`;
            })
            .join("");
        } else {
          notification.classList.add("hidden");
        }
      }

      // Update harvest countdown
      function updateHarvestCountdown() {
        const harvestItems = allData.filter((item) => item.type === "harvest");
        const upcomingHarvests = harvestItems
          .map((item) => {
            const data = JSON.parse(item.data);
            return { ...item, harvestDate: new Date(data.harvestDate) };
          })
          .filter((item) => item.harvestDate > new Date())
          .sort((a, b) => a.harvestDate - b.harvestDate);

        const countdownDisplay = document.getElementById("countdown-display");
        const countdownCommodity = document.getElementById(
          "countdown-commodity"
        );

        if (upcomingHarvests.length > 0) {
          const nextHarvest = upcomingHarvests[0];
          const now = new Date();
          const timeDiff = nextHarvest.harvestDate - now;
          const days = Math.ceil(timeDiff / (1000 * 60 * 60 * 24));

          countdownDisplay.textContent = `${days} hari`;
          countdownCommodity.textContent = `${
            nextHarvest.commodity
          } - ${nextHarvest.harvestDate.toLocaleDateString()}`;
        } else {
          countdownDisplay.textContent = "--";
          countdownCommodity.textContent = "Belum ada jadwal panen";
        }
      }

      // Initialize charts
      function initializeCharts() {
        // Progress Chart
        const progressCtx = document
          .getElementById("progress-chart")
          .getContext("2d");
        progressChart = new Chart(progressCtx, {
          type: "line",
          data: {
            labels: ["Jan", "Feb", "Mar", "Apr", "Mei", "Jun"],
            datasets: [
              {
                label: "Pengembalian Modal (%)",
                data: [0, 2, 5, 8, 12, 15],
                borderColor: "rgb(34, 197, 94)",
                backgroundColor: "rgba(34, 197, 94, 0.1)",
                tension: 0.4,
              },
            ],
          },
          options: {
            responsive: true,
            scales: {
              y: {
                beginAtZero: true,
                ticks: {
                  callback: function (value) {
                    return value + "%";
                  },
                },
              },
            },
          },
        });

        // Summary Chart
        const summaryCtx = document
          .getElementById("summary-chart")
          .getContext("2d");
        summaryChart = new Chart(summaryCtx, {
          type: "doughnut",
          data: {
            labels: ["Pemasukan", "Pengeluaran"],
            datasets: [
              {
                data: [0, 0],
                backgroundColor: ["rgb(34, 197, 94)", "rgb(239, 68, 68)"],
              },
            ],
          },
          options: {
            responsive: true,
          },
        });
      }

      // Update progress chart
      function updateProgressChart() {
        if (progressChart) {
          // Mock data - in real app, calculate from actual data
          const months = ["Jan", "Feb", "Mar", "Apr", "Mei", "Jun"];
          const returns = months.map(() => Math.random() * 20);

          progressChart.data.datasets[0].data = returns;
          progressChart.update();
        }
      }

      // Update summary chart
      function updateSummaryChart() {
        if (summaryChart) {
          const transactions = allData.filter(
            (item) => item.type === "transaction"
          );
          const totalIncome = transactions
            .filter((t) => t.category === "income")
            .reduce((sum, t) => sum + t.amount, 0);
          const totalExpense = transactions
            .filter((t) => t.category === "expense")
            .reduce((sum, t) => sum + t.amount, 0);

          summaryChart.data.datasets[0].data = [totalIncome, totalExpense];
          summaryChart.update();
        }
      }

      // Sample data embedded directly in HTML
      const sampleData = [
        // Sample investors
        {
          __backendId: "inv1",
          type: "investor",
          data: JSON.stringify({
            name: "Budi Santoso",
            initialCapital: 50000000,
            ownershipPercentage: 40,
          }),
          timestamp: "2024-01-15T00:00:00.000Z",
          commodity: "general",
          category: "investor",
          amount: 50000000,
          status: "active",
        },
        {
          __backendId: "inv2",
          type: "investor",
          data: JSON.stringify({
            name: "Siti Rahayu",
            initialCapital: 30000000,
            ownershipPercentage: 25,
          }),
          timestamp: "2024-01-20T00:00:00.000Z",
          commodity: "general",
          category: "investor",
          amount: 30000000,
          status: "active",
        },
        {
          __backendId: "inv3",
          type: "investor",
          data: JSON.stringify({
            name: "Ahmad Wijaya",
            initialCapital: 45000000,
            ownershipPercentage: 35,
          }),
          timestamp: "2024-01-25T00:00:00.000Z",
          commodity: "general",
          category: "investor",
          amount: 45000000,
          status: "active",
        },
        // Sample transactions - Income
        {
          __backendId: "trans1",
          type: "transaction",
          data: JSON.stringify({
            transactionType: "income",
            description: "Penjualan hasil panen timun batch 1",
          }),
          timestamp: "2024-02-15T00:00:00.000Z",
          commodity: "timun",
          category: "income",
          amount: 18500000,
          status: "completed",
        },
        {
          __backendId: "trans2",
          type: "transaction",
          data: JSON.stringify({
            transactionType: "income",
            description: "Penjualan bawang merah ke pasar induk",
          }),
          timestamp: "2024-02-20T00:00:00.000Z",
          commodity: "bawang-merah",
          category: "income",
          amount: 25000000,
          status: "completed",
        },
        {
          __backendId: "trans3",
          type: "transaction",
          data: JSON.stringify({
            transactionType: "income",
            description: "Penjualan cabai rawit ke distributor",
          }),
          timestamp: "2024-03-01T00:00:00.000Z",
          commodity: "cabai",
          category: "income",
          amount: 32000000,
          status: "completed",
        },
        // Sample transactions - Expenses
        {
          __backendId: "trans4",
          type: "transaction",
          data: JSON.stringify({
            transactionType: "expense",
            description: "Pembelian bibit timun hibrida",
          }),
          timestamp: "2024-01-10T00:00:00.000Z",
          commodity: "timun",
          category: "expense",
          amount: 3500000,
          status: "completed",
        },
        {
          __backendId: "trans5",
          type: "transaction",
          data: JSON.stringify({
            transactionType: "expense",
            description: "Pembelian pupuk NPK dan organik",
          }),
          timestamp: "2024-01-15T00:00:00.000Z",
          commodity: "general",
          category: "expense",
          amount: 8500000,
          status: "completed",
        },
        {
          __backendId: "trans6",
          type: "transaction",
          data: JSON.stringify({
            transactionType: "expense",
            description: "Biaya tenaga kerja bulanan",
          }),
          timestamp: "2024-02-01T00:00:00.000Z",
          commodity: "general",
          category: "expense",
          amount: 12000000,
          status: "completed",
        },
        {
          __backendId: "trans7",
          type: "transaction",
          data: JSON.stringify({
            transactionType: "expense",
            description: "Pembelian pestisida dan fungisida",
          }),
          timestamp: "2024-02-05T00:00:00.000Z",
          commodity: "general",
          category: "expense",
          amount: 4500000,
          status: "completed",
        },
        // Sample inventory items
        {
          __backendId: "inv_item1",
          type: "inventory",
          data: JSON.stringify({
            name: "Pupuk NPK 16-16-16",
            quantity: 75,
            unit: "kg",
          }),
          timestamp: "2024-01-25T00:00:00.000Z",
          commodity: "general",
          category: "inventory",
          amount: 75,
          status: "available",
        },
        {
          __backendId: "inv_item2",
          type: "inventory",
          data: JSON.stringify({
            name: "Pestisida Organik Neem",
            quantity: 8,
            unit: "liter",
          }),
          timestamp: "2024-02-01T00:00:00.000Z",
          commodity: "general",
          category: "inventory",
          amount: 8,
          status: "available",
        },
        {
          __backendId: "inv_item3",
          type: "inventory",
          data: JSON.stringify({
            name: "Bibit Timun Hibrida",
            quantity: 5,
            unit: "pack",
          }),
          timestamp: "2024-01-10T00:00:00.000Z",
          commodity: "timun",
          category: "inventory",
          amount: 5,
          status: "low",
        },
        {
          __backendId: "inv_item4",
          type: "inventory",
          data: JSON.stringify({
            name: "Mulsa Plastik Hitam Perak",
            quantity: 25,
            unit: "roll",
          }),
          timestamp: "2024-01-20T00:00:00.000Z",
          commodity: "general",
          category: "inventory",
          amount: 25,
          status: "available",
        },
        {
          __backendId: "inv_item5",
          type: "inventory",
          data: JSON.stringify({
            name: "Fungisida Sistemik",
            quantity: 3,
            unit: "liter",
          }),
          timestamp: "2024-02-10T00:00:00.000Z",
          commodity: "general",
          category: "inventory",
          amount: 3,
          status: "low",
        },
        // Sample harvest schedules
        {
          __backendId: "harvest1",
          type: "harvest",
          data: JSON.stringify({
            harvestDate: "2024-03-15",
            targetYield: 500,
            actualYield: 480,
          }),
          timestamp: "2024-01-15T00:00:00.000Z",
          commodity: "timun",
          category: "harvest",
          amount: 500,
          status: "completed",
        },
        {
          __backendId: "harvest2",
          type: "harvest",
          data: JSON.stringify({
            harvestDate: "2024-03-25",
            targetYield: 350,
            actualYield: 375,
          }),
          timestamp: "2024-02-01T00:00:00.000Z",
          commodity: "bawang-merah",
          category: "harvest",
          amount: 350,
          status: "completed",
        },
        {
          __backendId: "harvest3",
          type: "harvest",
          data: JSON.stringify({
            harvestDate: "2024-04-20",
            targetYield: 400,
            actualYield: 0,
          }),
          timestamp: "2024-02-15T00:00:00.000Z",
          commodity: "cabai",
          category: "harvest",
          amount: 400,
          status: "scheduled",
        },
        {
          __backendId: "harvest4",
          type: "harvest",
          data: JSON.stringify({
            harvestDate: "2024-05-10",
            targetYield: 600,
            actualYield: 0,
          }),
          timestamp: "2024-03-01T00:00:00.000Z",
          commodity: "tomat",
          category: "harvest",
          amount: 600,
          status: "scheduled",
        },
        // Sample disease records
        {
          __backendId: "disease1",
          type: "disease",
          data: JSON.stringify({
            name: "Layu Fusarium",
            symptoms:
              "Daun menguning dari bawah, batang mengering, tanaman layu",
            cause: "Jamur Fusarium oxysporum",
            treatment: "Aplikasi fungisida sistemik dan perbaikan drainase",
            severity: "medium",
          }),
          timestamp: "2024-02-10T00:00:00.000Z",
          commodity: "tomat",
          category: "disease",
          amount: 1,
          status: "treated",
        },
        {
          __backendId: "disease2",
          type: "disease",
          data: JSON.stringify({
            name: "Antraknosa",
            symptoms: "Bercak coklat kehitaman pada buah, buah membusuk",
            cause: "Jamur Colletotrichum capsici",
            treatment: "Penyemprotan fungisida berbahan aktif mankozeb",
            severity: "high",
          }),
          timestamp: "2024-02-20T00:00:00.000Z",
          commodity: "cabai",
          category: "disease",
          amount: 1,
          status: "active",
        },
        {
          __backendId: "disease3",
          type: "disease",
          data: JSON.stringify({
            name: "Embun Tepung",
            symptoms: "Lapisan putih seperti tepung pada permukaan daun",
            cause: "Jamur Erysiphe cichoracearum",
            treatment: "Aplikasi fungisida berbahan aktif sulfur",
            severity: "low",
          }),
          timestamp: "2024-03-01T00:00:00.000Z",
          commodity: "timun",
          category: "disease",
          amount: 1,
          status: "resolved",
        },
        {
          __backendId: "disease4",
          type: "disease",
          data: JSON.stringify({
            name: "Busuk Daun Bakteri",
            symptoms:
              "Bercak coklat dengan tepi kuning pada daun, daun mengering",
            cause: "Bakteri Xanthomonas campestris",
            treatment: "Penyemprotan bakterisida dan sanitasi lahan",
            severity: "medium",
          }),
          timestamp: "2024-03-05T00:00:00.000Z",
          commodity: "bawang-merah",
          category: "disease",
          amount: 1,
          status: "treated",
        },
      ];

      // Setup documentation navigation
      function setupDocumentationNavigation() {
        // Period type change
        document
          .getElementById("doc-period")
          .addEventListener("change", (e) => {
            currentPeriodType = e.target.value;
            switchNavigationType(currentPeriodType);
            updateDocumentationGallery();
          });

        // Daily navigation
        document.getElementById("prev-day").addEventListener("click", () => {
          if (currentDay > 1) {
            currentDay--;
            updateDayDisplay();
            updateDocumentationGallery();
          }
        });

        document.getElementById("next-day").addEventListener("click", () => {
          if (currentDay < 365) {
            currentDay++;
            updateDayDisplay();
            updateDocumentationGallery();
          }
        });

        // Weekly navigation
        document.getElementById("prev-week").addEventListener("click", () => {
          if (currentWeek > 1) {
            currentWeek--;
            updateWeekDisplay();
            updateDocumentationGallery();
          }
        });

        document.getElementById("next-week").addEventListener("click", () => {
          if (currentWeek < 52) {
            currentWeek++;
            updateWeekDisplay();
            updateDocumentationGallery();
          }
        });

        // Monthly navigation
        document.getElementById("prev-month").addEventListener("click", () => {
          if (currentMonth > 1) {
            currentMonth--;
            updateMonthDisplay();
            updateDocumentationGallery();
          }
        });

        document.getElementById("next-month").addEventListener("click", () => {
          if (currentMonth < 12) {
            currentMonth++;
            updateMonthDisplay();
            updateDocumentationGallery();
          }
        });

        // Quick navigation buttons
        document.querySelectorAll(".day-quick-nav").forEach((btn) => {
          btn.addEventListener("click", (e) => {
            currentDay = parseInt(e.target.dataset.day);
            updateDayDisplay();
            updateDocumentationGallery();
          });
        });

        document.querySelectorAll(".week-quick-nav").forEach((btn) => {
          btn.addEventListener("click", (e) => {
            currentWeek = parseInt(e.target.dataset.week);
            updateWeekDisplay();
            updateDocumentationGallery();
          });
        });

        document.querySelectorAll(".month-quick-nav").forEach((btn) => {
          btn.addEventListener("click", (e) => {
            currentMonth = parseInt(e.target.dataset.month);
            updateMonthDisplay();
            updateDocumentationGallery();
          });
        });

        // Commodity and date filters
        document
          .getElementById("doc-commodity")
          .addEventListener("change", updateDocumentationGallery);
        document
          .getElementById("doc-date")
          .addEventListener("change", updateDocumentationGallery);
      }

      // Switch navigation type
      function switchNavigationType(type) {
        // Hide all navigation types
        document.getElementById("daily-navigation").classList.add("hidden");
        document.getElementById("weekly-navigation").classList.add("hidden");
        document.getElementById("monthly-navigation").classList.add("hidden");

        // Show selected navigation type
        switch (type) {
          case "daily":
            document
              .getElementById("daily-navigation")
              .classList.remove("hidden");
            updateDayDisplay();
            break;
          case "weekly":
            document
              .getElementById("weekly-navigation")
              .classList.remove("hidden");
            updateWeekDisplay();
            break;
          case "monthly":
            document
              .getElementById("monthly-navigation")
              .classList.remove("hidden");
            updateMonthDisplay();
            break;
        }
      }

      // Update day display
      function updateDayDisplay() {
        document.getElementById(
          "current-day"
        ).textContent = `Hari ${currentDay}`;
        document.getElementById(
          "current-period-display"
        ).textContent = `Hari ${currentDay}`;
        document.getElementById(
          "gallery-period-info"
        ).textContent = `Menampilkan: Hari ${currentDay}`;
      }

      // Update week display
      function updateWeekDisplay() {
        document.getElementById(
          "current-week"
        ).textContent = `Minggu ${currentWeek}`;
        document.getElementById(
          "current-period-display"
        ).textContent = `Minggu ${currentWeek}`;
        document.getElementById(
          "gallery-period-info"
        ).textContent = `Menampilkan: Minggu ${currentWeek}`;
      }

      // Update month display
      function updateMonthDisplay() {
        document.getElementById(
          "current-month"
        ).textContent = `Bulan ${currentMonth}`;
        document.getElementById(
          "current-period-display"
        ).textContent = `Bulan ${currentMonth}`;
        document.getElementById(
          "gallery-period-info"
        ).textContent = `Menampilkan: Bulan ${currentMonth}`;
      }

      // Update documentation gallery
      function updateDocumentationGallery() {
        const gallery = document.getElementById("documentation-gallery");
        const commodity = document.getElementById("doc-commodity").value;
        const selectedDate = document.getElementById("doc-date").value;

        // Generate sample documentation based on current period
        const documentationItems = generateDocumentationItems();

        gallery.innerHTML = "";

        documentationItems.forEach((item) => {
          const docCard = document.createElement("div");
          docCard.className =
            "border rounded-lg p-4 hover:shadow-md transition-shadow";

          docCard.innerHTML = `
                    <div class="bg-gradient-to-br from-green-100 to-blue-100 h-48 rounded-lg mb-3 flex items-center justify-center relative overflow-hidden">
                        <div class="text-center">
                            <div class="text-3xl mb-2">${item.icon}</div>
                            <div class="text-sm font-medium text-gray-700">${item.title}</div>
                        </div>
                        <div class="absolute top-2 right-2 bg-white bg-opacity-80 px-2 py-1 rounded text-xs">
                            ${item.type}
                        </div>
                    </div>
                    <h4 class="font-medium text-gray-900">${item.commodity} - ${item.stage}</h4>
                    <p class="text-sm text-gray-600">${item.date}</p>
                    <p class="text-xs text-gray-500 mt-1">${item.description}</p>
                `;

          gallery.appendChild(docCard);
        });
      }

      // Generate documentation items based on current period
      function generateDocumentationItems() {
        const commodities = ["timun", "bawang-merah", "cabai", "tomat"];
        const selectedCommodity =
          document.getElementById("doc-commodity").value;
        const items = [];

        const filteredCommodities =
          selectedCommodity === "all" ? commodities : [selectedCommodity];

        filteredCommodities.forEach((commodity) => {
          let periodInfo, stageInfo, description;

          switch (currentPeriodType) {
            case "daily":
              periodInfo = `Hari ${currentDay}`;
              stageInfo = getDayStage(currentDay);
              description = getDayDescription(currentDay, commodity);
              break;
            case "weekly":
              periodInfo = `Minggu ${currentWeek}`;
              stageInfo = getWeekStage(currentWeek);
              description = getWeekDescription(currentWeek, commodity);
              break;
            case "monthly":
              periodInfo = `Bulan ${currentMonth}`;
              stageInfo = getMonthStage(currentMonth);
              description = getMonthDescription(currentMonth, commodity);
              break;
          }

          // Generate 2-3 items per commodity for the current period
          const itemCount = Math.floor(Math.random() * 2) + 2;

          for (let i = 0; i < itemCount; i++) {
            const types = ["📸 Foto", "🎥 Video", "📝 Catatan"];
            const icons = ["🌱", "🌿", "🌾", "🍃"];

            items.push({
              commodity:
                commodity.charAt(0).toUpperCase() +
                commodity.slice(1).replace("-", " "),
              stage: stageInfo,
              date: getFormattedDate(
                currentDay,
                currentWeek,
                currentMonth,
                currentPeriodType
              ),
              type: types[i % types.length],
              icon: icons[Math.floor(Math.random() * icons.length)],
              title: `${periodInfo} - ${stageInfo}`,
              description: description,
            });
          }
        });

        return items;
      }

      // Get stage based on day
      function getDayStage(day) {
        if (day <= 7) return "Penanaman";
        if (day <= 21) return "Pertumbuhan Awal";
        if (day <= 45) return "Pertumbuhan Vegetatif";
        if (day <= 70) return "Pembungaan";
        if (day <= 90) return "Pembuahan";
        return "Panen";
      }

      // Get stage based on week
      function getWeekStage(week) {
        if (week <= 2) return "Penanaman & Perkecambahan";
        if (week <= 6) return "Pertumbuhan Vegetatif";
        if (week <= 10) return "Pembungaan";
        if (week <= 13) return "Pembuahan";
        return "Panen";
      }

      // Get stage based on month
      function getMonthStage(month) {
        if (month <= 1) return "Persiapan & Penanaman";
        if (month <= 2) return "Pertumbuhan Vegetatif";
        if (month <= 3) return "Pembungaan & Pembuahan";
        return "Panen & Pasca Panen";
      }

      // Get descriptions
      function getDayDescription(day, commodity) {
        const descriptions = {
          timun: `Monitoring pertumbuhan timun hari ke-${day}. Pengamatan kondisi daun dan batang.`,
          "bawang-merah": `Dokumentasi perkembangan bawang merah hari ke-${day}. Cek kondisi umbi dan akar.`,
          cabai: `Pemantauan tanaman cabai hari ke-${day}. Observasi pertumbuhan dan kesehatan tanaman.`,
          tomat: `Pengamatan tomat hari ke-${day}. Dokumentasi fase pertumbuhan dan perkembangan buah.`,
        };
        return (
          descriptions[commodity] || `Dokumentasi pertumbuhan hari ke-${day}`
        );
      }

      function getWeekDescription(week, commodity) {
        return `Ringkasan perkembangan ${commodity} minggu ke-${week}. Evaluasi pertumbuhan dan perawatan.`;
      }

      function getMonthDescription(month, commodity) {
        return `Laporan bulanan ${commodity} bulan ke-${month}. Analisis hasil dan produktivitas.`;
      }

      // Get formatted date
      function getFormattedDate(day, week, month, type) {
        const baseDate = new Date("2024-01-15");
        let targetDate;

        switch (type) {
          case "daily":
            targetDate = new Date(
              baseDate.getTime() + (day - 1) * 24 * 60 * 60 * 1000
            );
            break;
          case "weekly":
            targetDate = new Date(
              baseDate.getTime() + (week - 1) * 7 * 24 * 60 * 60 * 1000
            );
            break;
          case "monthly":
            targetDate = new Date(
              baseDate.getFullYear(),
              baseDate.getMonth() + (month - 1),
              baseDate.getDate()
            );
            break;
        }

        return targetDate.toLocaleDateString("id-ID");
      }

      // Timer functions
      function startAllTimers() {
        // Clear existing intervals
        timerIntervals.forEach((interval) => clearInterval(interval));
        timerIntervals = [];

        // Business runtime timer (updates every second)
        const businessTimer = setInterval(updateBusinessRuntime, 1000);
        timerIntervals.push(businessTimer);

        // Planting countdown timer (updates every second)
        const countdownTimer = setInterval(updatePlantingCountdown, 1000);
        timerIntervals.push(countdownTimer);

        // Planting stopwatch timer (updates every 10ms for precision)
        const stopwatchTimer = setInterval(updatePlantingStopwatch, 10);
        timerIntervals.push(stopwatchTimer);

        // Initial updates
        updateBusinessRuntime();
        updatePlantingCountdown();
        updatePlantingStopwatch();
      }

      function updateBusinessRuntime() {
        const now = new Date();
        const elapsed = now - businessStartTime;
        const formatted = formatElapsedTime(elapsed);
        document.getElementById("business-runtime").textContent = formatted;
      }

      function updatePlantingCountdown() {
        const now = new Date();
        const remaining = nextPlantingTime - now;

        if (remaining <= 0) {
          document.getElementById("planting-countdown").textContent = "00:00";
          document.getElementById("next-planting-crop").textContent =
            "Waktunya Tanam!";
        } else {
          const formatted = formatRemainingTime(remaining);
          document.getElementById("planting-countdown").textContent = formatted;
        }
      }

      function updatePlantingStopwatch() {
        if (!isPlantingActive || !plantingStartTime) {
          return;
        }

        const now = new Date();
        const elapsed = now - plantingStartTime;
        const formatted = formatElapsedTime(elapsed);
        document.getElementById("planting-stopwatch").textContent = formatted;
      }

      function togglePlantingTimer() {
        const button = document.getElementById("planting-control");

        if (!isPlantingActive) {
          // Start planting
          isPlantingActive = true;
          plantingStartTime = new Date();
          button.textContent = "Selesai Tanam";
          button.classList.remove("bg-green-600", "hover:bg-green-700");
          button.classList.add("bg-red-600", "hover:bg-red-700");
          showNotification("Penanaman dimulai! Timer berjalan...");
        } else {
          // Stop planting
          isPlantingActive = false;
          const elapsed = new Date() - plantingStartTime;
          const duration = formatElapsedTime(elapsed);
          button.textContent = "Mulai Tanam";
          button.classList.remove("bg-red-600", "hover:bg-red-700");
          button.classList.add("bg-green-600", "hover:bg-green-700");
          showNotification(`Penanaman selesai! Durasi: ${duration}`);

          // Reset for next planting
          document.getElementById("planting-stopwatch").textContent = "00:00";
          plantingStartTime = null;
        }
      }

      function formatElapsedTime(milliseconds) {
        const totalSeconds = Math.floor(milliseconds / 1000);
        const totalMinutes = Math.floor(totalSeconds / 60);
        const totalHours = Math.floor(totalMinutes / 60);
        const totalDays = Math.floor(totalHours / 24);

        if (totalDays > 0) {
          const hours = totalHours % 24;
          return `${totalDays.toString().padStart(2, "0")}:${hours
            .toString()
            .padStart(2, "0")}`;
        } else if (totalHours > 0) {
          const minutes = totalMinutes % 60;
          return `${totalHours.toString().padStart(2, "0")}:${minutes
            .toString()
            .padStart(2, "0")}`;
        } else if (totalMinutes > 0) {
          const seconds = totalSeconds % 60;
          return `${totalMinutes.toString().padStart(2, "0")}:${seconds
            .toString()
            .padStart(2, "0")}`;
        } else {
          const centiseconds = Math.floor((milliseconds % 1000) / 10);
          return `${totalSeconds.toString().padStart(2, "0")}:${centiseconds
            .toString()
            .padStart(2, "0")}`;
        }
      }

      function formatRemainingTime(milliseconds) {
        const totalSeconds = Math.floor(milliseconds / 1000);
        const totalMinutes = Math.floor(totalSeconds / 60);
        const totalHours = Math.floor(totalMinutes / 60);
        const totalDays = Math.floor(totalHours / 24);

        if (totalDays > 0) {
          const hours = totalHours % 24;
          return `${totalDays.toString().padStart(2, "0")}:${hours
            .toString()
            .padStart(2, "0")}`;
        } else if (totalHours > 0) {
          const minutes = totalMinutes % 60;
          return `${totalHours.toString().padStart(2, "0")}:${minutes
            .toString()
            .padStart(2, "0")}`;
        } else {
          const seconds = totalSeconds % 60;
          return `${totalMinutes.toString().padStart(2, "0")}:${seconds
            .toString()
            .padStart(2, "0")}`;
        }
      }

      // Initialize app when DOM is loaded
      document.addEventListener("DOMContentLoaded", async () => {
        // Load sample data immediately
        allData = sampleData;

        await initializeApp();

        // Update all displays with sample data
        updateAllDisplays();
        updateFinancialSummary();
        updateInventoryDisplay();
        updateHarvestDisplay();
        updateDiseaseDisplay();
        updateSummaryDisplay();
        updateProgressChart();
        updateSummaryChart();
        checkLowStock();
        updateHarvestCountdown();

        // Initialize documentation gallery
        updateDocumentationGallery();

        showNotification("Sistem siap dengan data contoh lengkap!");
      });
    </script>
    <script>
      (function () {
        function c() {
          var b = a.contentDocument || a.contentWindow.document;
          if (b) {
            var d = b.createElement("script");
            d.innerHTML =
              "window.__CF$cv$params={r:'997af883046f445e',t:'MTc2MTk5NTY4OS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";
            b.getElementsByTagName("head")[0].appendChild(d);
          }
        }
        if (document.body) {
          var a = document.createElement("iframe");
          a.height = 1;
          a.width = 1;
          a.style.position = "absolute";
          a.style.top = 0;
          a.style.left = 0;
          a.style.border = "none";
          a.style.visibility = "hidden";
          document.body.appendChild(a);
          if ("loading" !== document.readyState) c();
          else if (window.addEventListener)
            document.addEventListener("DOMContentLoaded", c);
          else {
            var e = document.onreadystatechange || function () {};
            document.onreadystatechange = function (b) {
              e(b);
              "loading" !== document.readyState &&
                ((document.onreadystatechange = e), c());
            };
          }
        }
      })();
    </script>
  </body>
</html>
